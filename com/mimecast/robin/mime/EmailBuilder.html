<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (21) on Fri Oct 31 21:39:31 UTC 2025 -->
<title>EmailBuilder (robin 2.0.0-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-10-31">
<meta name="description" content="declaration: package: com.mimecast.robin.mime, class: EmailBuilder">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../javadoc.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/EmailBuilder.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li><a href="#field-summary">Field</a></li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li><a href="#field-detail">Field</a></li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.mimecast.robin.mime</a></div>
<h1 title="Class EmailBuilder" class="title">Class EmailBuilder</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">com.mimecast.robin.mime.EmailBuilder</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">EmailBuilder</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">EmailBuilder is a fluent MIME email message generator that constructs RFC 2822 compliant
 email messages with support for single-part and multipart structures.
 <p>
 This builder handles:
 <ul>
     <li>Header generation and encoding (UTF-8, RFC 2047 encoded words)</li>
     <li>Automatic insertion of required headers (Date, Message-ID, From, To, Subject)</li>
     <li>Multipart message composition (mixed, related, alternative)</li>
     <li>Content encoding (Base64, Quoted-Printable, plain text)</li>
     <li>Attachment and inline content management</li>
     <li>Header parameter extraction and manipulation</li>
 </ul>
 <p>
 The builder groups MIME parts by type:
 <ul>
     <li><b>Mixed</b> - Attachments and unrelated content</li>
     <li><b>Related</b> - Inline content referenced by other parts (images, stylesheets)</li>
     <li><b>Alternative</b> - Multiple representations of the same content (text/plain, text/html)</li>
 </ul>
 <p>
 The resulting multipart hierarchy follows RFC 2046 standards:
 <code>multipart/mixed &gt; multipart/related &gt; multipart/alternative</code>
 <p>
 This builder is designed as a reusable library for any Java application needing to
 construct email messages programmatically. It can be integrated into MTA implementations,
 email composition tools, or notification systems.
 <p>
 Example usage:
 <pre>
 Session session = new Session();
 MessageEnvelope envelope = new MessageEnvelope();
 envelope.setMail("sender@example.com");
 envelope.addRcpt("recipient@example.com");

 EmailBuilder builder = new EmailBuilder(session, envelope);
 builder.addHeader("Subject", "Test Email")
        .addHeader("From", "sender@example.com")
        .buildMime();

 ByteArrayOutputStream output = new ByteArrayOutputStream();
 builder.writeTo(output);
 </pre></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="headers/MimeHeader.html" title="class in com.mimecast.robin.mime.headers"><code>MimeHeader</code></a></li>
<li><a href="parts/MimePart.html" title="class in com.mimecast.robin.mime.parts"><code>MimePart</code></a></li>
<li><a href="../smtp/MessageEnvelope.html" title="class in com.mimecast.robin.smtp"><code>MessageEnvelope</code></a></li>
<li><a href="../smtp/session/Session.html" title="class in com.mimecast.robin.smtp.session"><code>Session</code></a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>protected final <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="parts/MimePart.html" title="class in com.mimecast.robin.mime.parts">MimePart</a>&gt;</code></div>
<div class="col-second even-row-color"><code><a href="#alternative" class="member-name-link">alternative</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>protected final <a href="../smtp/MessageEnvelope.html" title="class in com.mimecast.robin.smtp">MessageEnvelope</a></code></div>
<div class="col-second odd-row-color"><code><a href="#envelope" class="member-name-link">envelope</a></code></div>
<div class="col-last odd-row-color">
<div class="block">MessageEnvelope instance containing sender, recipients, and MIME configuration.</div>
</div>
<div class="col-first even-row-color"><code>protected final <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="headers/MimeHeader.html" title="class in com.mimecast.robin.mime.headers">MimeHeader</a>&gt;</code></div>
<div class="col-second even-row-color"><code><a href="#headers" class="member-name-link">headers</a></code></div>
<div class="col-last even-row-color">
<div class="block">List of parsed and generated email headers.</div>
</div>
<div class="col-first odd-row-color"><code>(package private) static final org.apache.logging.log4j.Logger</code></div>
<div class="col-second odd-row-color"><code><a href="#log" class="member-name-link">log</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected boolean</code></div>
<div class="col-second even-row-color"><code><a href="#logTextPartsBody" class="member-name-link">logTextPartsBody</a></code></div>
<div class="col-last even-row-color">
<div class="block">Debug flag to enable logging of text part body content.</div>
</div>
<div class="col-first odd-row-color"><code>protected final <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="parts/MimePart.html" title="class in com.mimecast.robin.mime.parts">MimePart</a>&gt;</code></div>
<div class="col-second odd-row-color"><code><a href="#mixed" class="member-name-link">mixed</a></code></div>
<div class="col-last odd-row-color">
<div class="block">MIME parts grouped by type for multipart message composition.</div>
</div>
<div class="col-first even-row-color"><code>protected final <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="parts/MimePart.html" title="class in com.mimecast.robin.mime.parts">MimePart</a>&gt;</code></div>
<div class="col-second even-row-color"><code><a href="#related" class="member-name-link">related</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>protected final <a href="../smtp/session/Session.html" title="class in com.mimecast.robin.smtp.session">Session</a></code></div>
<div class="col-second odd-row-color"><code><a href="#session" class="member-name-link">session</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Session instance containing configuration and variable substitution context.</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(com.mimecast.robin.smtp.session.Session,com.mimecast.robin.smtp.MessageEnvelope)" class="member-name-link">EmailBuilder</a><wbr>(<a href="../smtp/session/Session.html" title="class in com.mimecast.robin.smtp.session">Session</a>&nbsp;session,
 <a href="../smtp/MessageEnvelope.html" title="class in com.mimecast.robin.smtp">MessageEnvelope</a>&nbsp;envelope)</code></div>
<div class="col-last even-row-color">
<div class="block">Constructs a new EmailBuilder instance with given Session and MessageEnvelope.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="EmailBuilder.html" title="class in com.mimecast.robin.mime">EmailBuilder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#addHeader(java.lang.String,java.lang.String)" class="member-name-link">addHeader</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;value)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Adds an email header with automatic encoding for non-ASCII characters.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#addMissingHeaders()" class="member-name-link">addMissingHeaders</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Adds missing required RFC 2822 headers before message output.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="EmailBuilder.html" title="class in com.mimecast.robin.mime">EmailBuilder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#addPart(com.mimecast.robin.mime.parts.MimePart)" class="member-name-link">addPart</a><wbr>(<a href="parts/MimePart.html" title="class in com.mimecast.robin.mime.parts">MimePart</a>&nbsp;part)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Adds a MIME part to the message with automatic categorization.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="EmailBuilder.html" title="class in com.mimecast.robin.mime">EmailBuilder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildMime()" class="member-name-link">buildMime</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Builds the email structure from the MessageEnvelope MIME configuration.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#makeMultipart(java.io.OutputStream,java.lang.String)" class="member-name-link">makeMultipart</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;outputStream,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;type)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Writes multipart header section for a given multipart type.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="EmailBuilder.html" title="class in com.mimecast.robin.mime">EmailBuilder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setLogTextPartsBody(boolean)" class="member-name-link">setLogTextPartsBody</a><wbr>(boolean&nbsp;logTextPartsBody)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets the debug flag to enable/disable logging of text part body content.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#writeMultipartParts(java.io.OutputStream,java.util.List,java.lang.String)" class="member-name-link">writeMultipartParts</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;outputStream,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="parts/MimePart.html" title="class in com.mimecast.robin.mime.parts">MimePart</a>&gt;&nbsp;parts,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;type)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Writes all parts within a multipart section with proper boundary delimiters.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#writeMultiparts(java.io.OutputStream)" class="member-name-link">writeMultiparts</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;outputStream)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Writes multipart message structure with appropriate boundaries and nesting.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="EmailBuilder.html" title="class in com.mimecast.robin.mime">EmailBuilder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#writeTo(java.io.OutputStream)" class="member-name-link">writeTo</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;outputStream)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Writes the complete email message to an output stream.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="log">
<h3>log</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">org.apache.logging.log4j.Logger</span>&nbsp;<span class="element-name">log</span></div>
</section>
</li>
<li>
<section class="detail" id="session">
<h3>session</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type"><a href="../smtp/session/Session.html" title="class in com.mimecast.robin.smtp.session">Session</a></span>&nbsp;<span class="element-name">session</span></div>
<div class="block">Session instance containing configuration and variable substitution context.
 Used for magic token replacement in headers and message content.</div>
</section>
</li>
<li>
<section class="detail" id="envelope">
<h3>envelope</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type"><a href="../smtp/MessageEnvelope.html" title="class in com.mimecast.robin.smtp">MessageEnvelope</a></span>&nbsp;<span class="element-name">envelope</span></div>
<div class="block">MessageEnvelope instance containing sender, recipients, and MIME configuration.
 Provides the high-level structure and content for the email message.</div>
</section>
</li>
<li>
<section class="detail" id="headers">
<h3>headers</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="headers/MimeHeader.html" title="class in com.mimecast.robin.mime.headers">MimeHeader</a>&gt;</span>&nbsp;<span class="element-name">headers</span></div>
<div class="block">List of parsed and generated email headers.
 Includes standard headers (From, To, Date, etc.) and custom headers.
 Headers are encoded using RFC 2047 for non-ASCII characters.</div>
</section>
</li>
<li>
<section class="detail" id="mixed">
<h3>mixed</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="parts/MimePart.html" title="class in com.mimecast.robin.mime.parts">MimePart</a>&gt;</span>&nbsp;<span class="element-name">mixed</span></div>
<div class="block">MIME parts grouped by type for multipart message composition.
 <b>mixed</b> - Contains attachments and unrelated content (lowest priority in hierarchy)
 <b>related</b> - Contains inline content referenced by other parts (images, stylesheets)
 <b>alternative</b> - Contains alternative representations of same content (text/plain, text/html)</div>
</section>
</li>
<li>
<section class="detail" id="related">
<h3>related</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="parts/MimePart.html" title="class in com.mimecast.robin.mime.parts">MimePart</a>&gt;</span>&nbsp;<span class="element-name">related</span></div>
</section>
</li>
<li>
<section class="detail" id="alternative">
<h3>alternative</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="parts/MimePart.html" title="class in com.mimecast.robin.mime.parts">MimePart</a>&gt;</span>&nbsp;<span class="element-name">alternative</span></div>
</section>
</li>
<li>
<section class="detail" id="logTextPartsBody">
<h3>logTextPartsBody</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">logTextPartsBody</span></div>
<div class="block">Debug flag to enable logging of text part body content.
 When enabled, the content of all text/* parts is logged after parsing.
 Useful for debugging MIME composition but should be disabled in production.</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(com.mimecast.robin.smtp.session.Session,com.mimecast.robin.smtp.MessageEnvelope)">
<h3>EmailBuilder</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">EmailBuilder</span><wbr><span class="parameters">(<a href="../smtp/session/Session.html" title="class in com.mimecast.robin.smtp.session">Session</a>&nbsp;session,
 <a href="../smtp/MessageEnvelope.html" title="class in com.mimecast.robin.smtp">MessageEnvelope</a>&nbsp;envelope)</span></div>
<div class="block">Constructs a new EmailBuilder instance with given Session and MessageEnvelope.
 <p>
 Initializes the builder with MIME version 1.0 header. The session provides context
 for variable substitution in headers and content, while the envelope supplies sender,
 recipients, and base MIME configuration for the message.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>session</code> - Session instance containing configuration and variable context</dd>
<dd><code>envelope</code> - MessageEnvelope instance containing sender, recipients, and MIME configuration</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="buildMime()">
<h3>buildMime</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="EmailBuilder.html" title="class in com.mimecast.robin.mime">EmailBuilder</a></span>&nbsp;<span class="element-name">buildMime</span>()</div>
<div class="block">Builds the email structure from the MessageEnvelope MIME configuration.
 <p>
 Extracts all MIME parts from the envelope's MimeConfig and categorizes them:
 <ul>
     <li>Parts with Content-ID header are classified as <b>related</b></li>
     <li>Text parts without attachment disposition are classified as <b>alternative</b></li>
     <li>All other parts are classified as <b>mixed</b></li>
 </ul>
 Also processes all headers from the envelope configuration with magic token replacement.
 Optional logging of text part bodies is available for debugging.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>Self for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="addHeader(java.lang.String,java.lang.String)">
<h3>addHeader</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="EmailBuilder.html" title="class in com.mimecast.robin.mime">EmailBuilder</a></span>&nbsp;<span class="element-name">addHeader</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;value)</span></div>
<div class="block">Adds an email header with automatic encoding for non-ASCII characters.
 <p>
 Applies RFC 2047 encoded-word encoding for headers containing non-ASCII characters
 or multiline values. Multiline values are encoded in Base64 format, while single-line
 values use appropriate MIME encoding. If encoding fails, the header is added with
 unfolded newlines for maximum compatibility.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>name</code> - Header name (e.g., "Subject", "From", "X-Custom-Header")</dd>
<dd><code>value</code> - Header value, may contain non-ASCII characters or newlines</dd>
<dt>Returns:</dt>
<dd>Self for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="addMissingHeaders()">
<h3>addMissingHeaders</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">addMissingHeaders</span>()</div>
<div class="block">Adds missing required RFC 2822 headers before message output.
 <p>
 Automatically generates the following headers if not already present:
 <ul>
     <li><b>Date</b> - Current date/time in RFC 2822 format</li>
     <li><b>Message-ID</b> - Unique message identifier using UUID</li>
     <li><b>Subject</b> - Default subject with Message-ID if not provided</li>
     <li><b>From</b> - Sender address from MessageEnvelope</li>
     <li><b>To</b> - Recipient addresses from MessageEnvelope</li>
 </ul>
 This ensures the generated message is RFC 2822 compliant and can be accepted
 by SMTP servers and email clients.</div>
</section>
</li>
<li>
<section class="detail" id="addPart(com.mimecast.robin.mime.parts.MimePart)">
<h3>addPart</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="EmailBuilder.html" title="class in com.mimecast.robin.mime">EmailBuilder</a></span>&nbsp;<span class="element-name">addPart</span><wbr><span class="parameters">(<a href="parts/MimePart.html" title="class in com.mimecast.robin.mime.parts">MimePart</a>&nbsp;part)</span></div>
<div class="block">Adds a MIME part to the message with automatic categorization.
 <p>
 Classifies the part based on headers:
 <ul>
     <li>Parts with Content-ID header → <b>related</b> (inline content)</li>
     <li>Text parts without attachment disposition → <b>alternative</b> (content alternatives)</li>
     <li>All other parts → <b>mixed</b> (attachments and unrelated content)</li>
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>part</code> - MimePart instance to add to the message</dd>
<dt>Returns:</dt>
<dd>Self for method chaining</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="writeTo(java.io.OutputStream)">
<h3>writeTo</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="EmailBuilder.html" title="class in com.mimecast.robin.mime">EmailBuilder</a></span>&nbsp;<span class="element-name">writeTo</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;outputStream)</span>
                     throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Writes the complete email message to an output stream.
 <p>
 Performs the following steps:
 <ol>
     <li>Adds any missing required headers (Date, Message-ID, From, To, Subject)</li>
     <li>Writes all headers to the output stream</li>
     <li>For single-part messages: writes the part content directly</li>
     <li>For multipart messages: constructs nested multipart structure with boundaries</li>
 </ol>
 The multipart hierarchy follows this structure (outermost to innermost):
 <code>multipart/mixed → multipart/related → multipart/alternative</code></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>outputStream</code> - OutputStream to write the complete RFC 2822 message to</dd>
<dt>Returns:</dt>
<dd>Self for method chaining</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - If an error occurs while writing to the output stream</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="writeMultiparts(java.io.OutputStream)">
<h3>writeMultiparts</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">writeMultiparts</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;outputStream)</span>
                      throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Writes multipart message structure with appropriate boundaries and nesting.
 <p>
 Constructs the multipart hierarchy based on which part categories are present:
 <ul>
     <li>If mixed parts exist: creates outermost multipart/mixed boundary</li>
     <li>If related parts exist: creates multipart/related boundary</li>
     <li>If alternative parts exist: creates multipart/alternative boundary</li>
 </ul>
 Boundaries follow the format: <code>--robinMixed</code>, <code>--robinRelated</code>, <code>--robinAlternative</code>
 with closing boundaries <code>--robinMixed--</code>, etc.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>outputStream</code> - OutputStream to write the multipart structure to</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - If an error occurs while writing to the output stream</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="makeMultipart(java.io.OutputStream,java.lang.String)">
<h3>makeMultipart</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">makeMultipart</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;outputStream,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;type)</span>
                    throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Writes multipart header section for a given multipart type.
 <p>
 Generates a Content-Type header with the appropriate boundary parameter
 and writes the opening boundary marker. This prepares the output stream for
 writing the parts that follow within this multipart section.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>outputStream</code> - OutputStream to write the multipart header to</dd>
<dd><code>type</code> - Multipart type: "mixed", "related", or "alternative"</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - If an error occurs while writing to the output stream</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="writeMultipartParts(java.io.OutputStream,java.util.List,java.lang.String)">
<h3>writeMultipartParts</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">writeMultipartParts</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;outputStream,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="parts/MimePart.html" title="class in com.mimecast.robin.mime.parts">MimePart</a>&gt;&nbsp;parts,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;type)</span>
                          throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Writes all parts within a multipart section with proper boundary delimiters.
 <p>
 Writes each part's content followed by the boundary delimiter. The final part
 is followed by a closing boundary (with "--" suffix) to indicate the end of
 the multipart section. Each part is responsible for writing its own headers
 and content via the MimePart.writeTo() method.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>outputStream</code> - OutputStream to write the parts to</dd>
<dd><code>parts</code> - List of MimePart instances to write</dd>
<dd><code>type</code> - Multipart type used to generate boundary markers</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - If an error occurs while writing to the output stream</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setLogTextPartsBody(boolean)">
<h3>setLogTextPartsBody</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="EmailBuilder.html" title="class in com.mimecast.robin.mime">EmailBuilder</a></span>&nbsp;<span class="element-name">setLogTextPartsBody</span><wbr><span class="parameters">(boolean&nbsp;logTextPartsBody)</span></div>
<div class="block">Sets the debug flag to enable/disable logging of text part body content.
 <p>
 When enabled (true), the content of all text/* parts discovered during
 buildMime() will be logged at INFO level with newlines escaped as "\\".
 This is useful for debugging MIME composition but should be disabled
 in production environments to avoid logging sensitive message content.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>logTextPartsBody</code> - true to enable body logging, false to disable</dd>
<dt>Returns:</dt>
<dd>Self for method chaining</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2025. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
