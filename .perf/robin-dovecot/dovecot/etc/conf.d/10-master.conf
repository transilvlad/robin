# Service configuration for performance testing

# Disable imap-urlauth-worker (not needed for LMTP testing)
service imap-urlauth-worker {
  user = root
  group = root
  extra_groups = root
  unix_listener imap-urlauth-worker {
    user = root
  }
}

# Auth service for Postfix SASL
service auth {
  unix_listener /var/run/dovecot/auth {
    mode = 0666
  }

  unix_listener auth-client {
    mode = 0666
  }

  unix_listener auth-userdb {
    mode = 0666
  }
}

# IMAP service for mailbox access
service imap-login {
  inet_listener imap {
    port = 143
  }
}

service imap-hibernate {
  unix_listener imap-hibernate {
    user = root
    group = root
  }
}

service imap {
  process_limit = 1024
  user = root
  group = root
  extra_groups = root
}

# LMTP service for MTA integration
service lmtp {
  # TCP listener for Robin (port 24)
  inet_listener lmtp {
    port = 24
  }

  # Performance tuning for high-concurrency testing
  process_limit = 200          # Allow up to 200 concurrent LMTP processes
  client_limit = 1             # One client per process (LMTP standard)
  vsz_limit = 256M
  user = root
  group = root
  extra_groups = root
}

service dict {
  unix_listener dict {
    mode = 0660
    user = root
    group = root
  }
}

service dict-async {
  unix_listener dict-async {
    mode = 0660
    user = root
    group = root
  }
}

service doveadm {
  user = root
  group = root
  extra_groups = root
}

service indexer {
  user = root
  group = root
  extra_groups = root
}

service indexer-worker {
  user = root
  group = root
  extra_groups = root
}

service stats {
  unix_listener stats-writer {
    mode = 0660
    user = root
    group = root
  }
}
